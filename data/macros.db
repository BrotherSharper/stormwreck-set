{"name":"New Macro","type":"script","scope":"global","author":"56XXUfEqcHxosB5B","img":"icons/svg/dice-target.svg","command":"// IMPORTANT NOTES: \n// 1) THIS MACRO MUST BE LAUNCHED IN A 2.0.3 WORLDS IF YOU DON'T HAVE A BACKUP SADLY YOU LOST THE JOURNAL DATA\n// 2) THIS MACRO MUST NOT BE LAUNCHED IN A 2.1.X WORLD\n// 3) BEFORE LAUNCH THIS MACRO DO A BACKUP OF THE CURRENT WORLD JUST TO BE SAFE\n// Ty to @zhell for the macro\nconst updates = game.actors.reduce((acc, a) => {\n    const flags = foundry.utils.getProperty(a, \"flags.tidy5e-sheet\") ?? {};\n    const asd = a.system.details ?? {};\n    const upd = {};\n    const props = {\n        \"character\": [\"gender\", \"age\", \"height\", \"weight\", \"eyes\", \"skin\", \"hair\", \"maxPreparedSpells\"],\n        \"npc\": [\"trait\", \"ideal\", \"bond\", \"flaw\"]\n    } [a.type];\n    if (!props) {\n      return acc;\n    }\n    for (const prop of props) {\n      upd[prop] = asd[prop] || flags[prop] || \"\";\n    }\n    const notes = [\"notes\", \"notes1\", \"notes2\", \"notes3\", \"notes4\"];\n    for (const n of notes) {\n      upd[`${n}.value`] = asd[n]?.value || flags[n]?.value || \"\";\n    }\n    acc.push({\n        _id: a.id,\n        \"flags.tidy5e-sheet\": upd\n    });\n    return acc;\n}, []);\nawait Actor.updateDocuments(updates);","folder":null,"sort":0,"ownership":{"default":0,"56XXUfEqcHxosB5B":3},"flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1675429960469,"modifiedTime":1675429965536,"lastModifiedBy":"56XXUfEqcHxosB5B"},"_id":"8L6IjLyQhUXZOldU"}
